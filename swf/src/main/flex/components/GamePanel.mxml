<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml"
        label="Game {game.id}"
        creationComplete="initializeTable()"
        layout="horizontal">
    <mx:Script>
    <![CDATA[

        import com.flexpoker.events.SendChatMessageEvent;
        import com.flexpoker.model.Game;
        import mx.messaging.Consumer;
        import mx.messaging.ChannelSet;
        import mx.messaging.messages.IMessage;
        import mx.controls.Alert;
        import mx.rpc.events.FaultEvent;
        import mx.rpc.events.ResultEvent;
        import mx.messaging.messages.AsyncMessage;
        import com.flexpoker.util.RemoteObjectUtils;

        public var game:Game;
        
        public var channelSet:ChannelSet;
        
        private function initializeTable() {
            consumer.subtopic = "gameStatusUpdates." + game.id.toString() + ".*";
            consumer.subscribe();
            RemoteObjectUtils.addChannelSetToRemoteObject(mainRemoteObject);
        }
        
        private function messageHandler(message:IMessage):void {
            Alert.show("acknowledge");
        }
        
        private function produceMessage():void {
            var message:AsyncMessage = new AsyncMessage();
            producer.subtopic = "gameStatusUpdates." + game.id.toString();
            message.body = "wow";
            producer.send(message);
        }
        
        [Embed(source="/assets/Table.svg")]
        [Bindable]
        public var TableSvg:Class; 

    ]]>
    </mx:Script>

    <mx:Producer id="producer" destination="gameStatusUpdates" channelSet="{channelSet}" />
    <mx:Consumer id="consumer" destination="gameStatusUpdates"
    channelSet="{channelSet}" message="messageHandler(event.message)" />
    
    <mx:RemoteObject id="mainRemoteObject" destination="flexController">
        <mx:method name="joinGame" fault="joinGameFaultHandler(event)" />
    </mx:RemoteObject>

    <mx:VBox verticalAlign="middle" horizontalAlign="middle" height="100%"
        width="80%" backgroundImage="{TableSvg}">

        <mx:Spacer height="100%" />
        <mx:HBox width="100%">
            <mx:Spacer width="100%" />
            <mx:Label text="2" />
            <mx:Spacer width="25%" />
            <mx:Label text="3" />
            <mx:Spacer width="100%" />
        </mx:HBox>
        <mx:Spacer height="45%" />
        <mx:HBox width="100%">
            <mx:Spacer width="100%" />
            <mx:Label text="1" />
            <mx:Spacer width="100%" />
            <mx:Label text="4" />
            <mx:Spacer width="100%" />
        </mx:HBox>
        <mx:Spacer height="100%" />
        <mx:HBox width="100%">
            <mx:Spacer width="60%" />
            <mx:Label text="10" />
            <mx:Spacer width="100%" />
            <mx:Label text="5" />
            <mx:Spacer width="60%" />
        </mx:HBox>
        <mx:Spacer height="100%" />
        <mx:HBox width="100%">
            <mx:Spacer width="100%" />
            <mx:Label text="9" />
            <mx:Spacer width="100%" />
            <mx:Label text="6" />
            <mx:Spacer width="100%" />
        </mx:HBox>
        <mx:Spacer height="45%" />
        <mx:HBox width="100%">
            <mx:Spacer width="100%" />
            <mx:Label text="8" />
            <mx:Spacer width="25%" />
            <mx:Label text="7" />
            <mx:Spacer width="100%" />
        </mx:HBox>
        <mx:Spacer height="100%" />

    </mx:VBox>

    <mx:VBox height="100%" width="20%">
        <mx:HSlider id="betSlider" tickInterval="2" labels="['0', '100']" maximum="100"
                minimum="0" height="150" />
        <mx:Text text="{Math.round(betSlider.value)}" />
        <mx:Button label="Bet" />
        <mx:Button label="Check" />
        <mx:Button label="Fold" />
    </mx:VBox>

</mx:Panel>
